<!--pages/packageA/training/edit/edit.wxml-->
<view class="container">
    <view class="page-title">
        {{id ? (id + '. ') : '私教体验课'}}
        <block wx:if="{{!editFlag}}">
            {{id ? (name || '') : ''}}
            <view class="save-btn add-one-btn" bindtap="edit">编辑</view>
        </block>
        <block wx:else>
            <input wx:if="{{id}}" bindinput="inputNameChange" data-name="name" class="weui-input" placeholder="请输入课程名称" value="{{name}}"/>
            <view class="save-btn add-one-btn" bindtap="saveList">保存</view>
        </block>
    </view>
    <view class="training-list">
        <view class="training-item" wx:for="{{trainingList}}" wx:key="index">
            <view class="training-title">{{item.name}}</view>
            <view class="action-list" wx:if="{{item.actionList.length}}">
                <view wx:for="{{item.actionList}}" wx:for-index="i" wx:key="index" wx:for-item="action" class="action-item"> 
                    <block wx:if="{{!editFlag}}">
                    <!--预览状态-->
                    <mp-cell wx:for="{{items}}" wx:key="index" wx:for-item="ia" title="{{ia.name}}" footer="{{action[ia.id]}}"></mp-cell>
                    <view class="user-video-wrapper video-wrapper" wx:if="{{action.video}}">
                        <video class="user-video" src="{{action.video}}"></video>
                    </view>
                    </block>
                    <block wx:else>
                    <!--编辑状态-->
                    <mp-cell ext-class="weui-cell_select weui-cell_select-after">
                        <view slot="title" class="weui-label">训练部位</view>
                        <picker class="physical-item-input" bindchange="bindSelChangeEdit" data-name="part" data-index="{{index}}" data-i="{{i}}" value="{{action.partIndex}}" range="{{trainingPart}}" range-key="name">
                            <view class="weui-select">{{trainingPart[action.partIndex].name}}</view>
                        </picker>
                    </mp-cell>
                    <view>
                        <mp-cell ext-class="weui-cell_select weui-cell_select-after">
                            <view slot="title" class="weui-label">动作</view>
                            <picker class="physical-item-input" bindchange="bindSelChangeEdit" data-i="{{i}}" data-name="action" data-index="{{index}}" value="{{action.actionIndex}}" range="{{trainingPart[action.partIndex].actionList}}" disabled="{{!action.part}}">
                                <view class="weui-select">{{trainingPart[action.partIndex].actionList[action.actionIndex]}}</view>
                            </picker>
                        </mp-cell>
                        <mp-cell ext-class="weui-cell_select weui-cell_select-after">
                            <view slot="title" class="weui-label">器械</view>
                            <picker class="physical-item-input" bindchange="bindSelChangeEdit" data-i="{{i}}" data-name="equipment" data-index="{{index}}" value="{{action.equipmentIndex}}" range="{{equipment}}">
                                <view class="weui-select">{{equipment[action.equipmentIndex]}}</view>
                            </picker>
                        </mp-cell>    
                        <mp-cell prop="ounterweight" title="配重">
                            <input bindinput="inputChangeEdit" data-i="{{i}}" data-index="{{index}}" data-name="ounterweight" class="weui-input" placeholder="" value="{{action.ounterweight}}" />
                        </mp-cell>    
                        <mp-cell prop="times" title="单组次数">
                            <input bindinput="inputChangeEdit" data-i="{{i}}" data-index="{{index}}" data-name="times" class="weui-input" placeholder="" value="{{action.times}}"/>
                        </mp-cell>    
                        <mp-cell prop="groups" title="组数">
                            <input bindinput="inputChangeEdit" data-i="{{i}}" data-index="{{index}}" data-name="groups" class="weui-input" placeholder="" value="{{action.groups}}"/>
                        </mp-cell>
                    </view>
                    <view class="user-video-wrapper video-wrapper" wx:if="{{action.video}}">
                        <video class="user-video" src="{{action.video}}"></video>
                        <view class="del-act-btn" bindtap="delAct" data-index="{{index}}" data-i="{{i}}">
                            <mp-icon type="field" icon="close" color="#fff" size="{{10}}"></mp-icon>
                        </view>
                    </view>
                    <view class="eva-camera-wrapper video-wrapper" wx:else>
                        <view class="eva-camera" bindtap="startVideo" data-index="{{index}}" data-i="{{i}}">
                            <mp-icon type="field" icon="video-call" color="gray" size="{{20}}"></mp-icon>
                            <view>添加训练视频</view>
                        </view>
                    </view>
                    <view class="edit-one">
                        <!-- <view class="add-one-btn add-one-btn-edit" bindtap="editOne" data-index="{{index}}" data-a="{{i}}">编辑</view> -->
                        <view class="add-one-btn add-one-btn-del" bindtap="delOne" data-index="{{index}}" data-a="{{i}}">删除</view>
                    </view>
                    </block>
                </view>
            </view>
            <view wx:if="{{item.showAdd}}" class="add-one">    
                <mp-cell ext-class="weui-cell_select weui-cell_select-after">
                    <view slot="title" class="weui-label">训练部位</view>
                    <picker class="physical-item-input" bindchange="bindSelChange" data-name="part" data-index="{{index}}" value="{{item.detail.partIndex}}" range="{{trainingPart}}" range-key="name">
                        <view class="weui-select">{{trainingPart[item.detail.partIndex].name}}</view>
                    </picker>
                </mp-cell>
                <view>
                    <mp-cell ext-class="weui-cell_select weui-cell_select-after">
                        <view slot="title" class="weui-label">动作</view>
                        <picker class="physical-item-input" bindchange="bindSelChange" data-name="action" data-index="{{index}}" value="{{item.detail.actionIndex}}" range="{{trainingPart[item.detail.partIndex].actionList}}" disabled="{{!item.detail.part}}">
                            <view class="weui-select">{{trainingPart[item.detail.partIndex].actionList[item.detail.actionIndex]}}</view>
                        </picker>
                    </mp-cell>
                    <mp-cell ext-class="weui-cell_select weui-cell_select-after">
                        <view slot="title" class="weui-label">器械</view>
                        <picker class="physical-item-input" bindchange="bindSelChange" data-name="equipment" data-index="{{index}}" value="{{item.detail.equipmentIndex}}" range="{{equipment}}">
                            <view class="weui-select">{{equipment[item.detail.equipmentIndex]}}</view>
                        </picker>
                    </mp-cell>    
                    <mp-cell prop="ounterweight" title="配重">
                        <input bindinput="inputChange" data-index="{{index}}" data-name="ounterweight" class="weui-input" placeholder="" value="{{item.detail.ounterweight}}" />
                    </mp-cell>    
                    <mp-cell prop="times" title="单组次数">
                        <input bindinput="inputChange" data-index="{{index}}" data-name="times" class="weui-input" placeholder="" value="{{item.detail.times}}"/>
                    </mp-cell>    
                    <mp-cell prop="groups" title="组数">
                        <input bindinput="inputChange" data-index="{{index}}" data-name="groups" class="weui-input" placeholder="" value="{{item.detail.groups}}"/>
                    </mp-cell>
                    <view class="add-one-bottom">
                        <view class="add-one-btn" bindtap="saveOne" data-index="{{index}}">保存</view>
                        <view class="add-one-btn add-one-btn-cancel" bindtap="cancelOne" data-index="{{index}}">取消</view>
                    </view>
                </view>
            </view>
            <view wx:elif="{{editFlag}}" class="training-add" bindtap="addone" data-index="{{index}}">+ 添加动作</view>
        </view>
    </view>
</view>

